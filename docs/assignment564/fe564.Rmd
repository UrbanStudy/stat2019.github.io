---
title: 'Shen Qu, 918881147'
author: "STAT564 Fall 2018 Final Exam"
date: "12/05/2018"
output: 
  html_document:
    toc: false
    toc_float: false
---

```{r setup, include=F}
knitr::opts_chunk$set(message=FALSE, warning=F, echo=TRUE)
options(width = 2000)
options(repos="https://cran.rstudio.com")
```

# {.tabset}

## 

### Question 1 (Show main steps of your work to get full points)

The $(X'X)^{-1}$ for the $y=β_0+β_1 x_1+β_2 x_2+β_3 x_3+β_4 x_4+β_5 x_5+β_6 x_6+ε$ is given below.

```{R eval=FALSE, collapse=TRUE, include=FALSE}

B<- data.frame(
   b0=c(3.694,	-2.166,	0.046,	-0.300,	-0.022,	-0.100,	0.023),
   b1=c(-2.166,	2.230,	-0.075,	0.166,	0.012,	-0.079,	-0.015),
   b2=c(0.046,	-0.075,	0.067,	-0.010,	-0.035,	-0.009,	-0.027),
   b3=c(-0.300,	0.166,	-0.010,	0.083,	-0.028,	-0.010,	-0.010),
   b4=c(-0.0216,	0.012,	-0.035,	-0.028,	0.069,	-0.003,	-0.003),
   b5=c(-0.100,	-0.079,	-0.099,	-0.010,	-0.003,	0.058,	0.015),
   b6=c(0.023,	-0.015,	-0.027,	-0.010,	-0.003,	0.015,	0.063)
   )
# Var($\hat b_4$)
1.395*B[5,5]
# se(b4)
sqrt(1.395*B[5,5])
# se(b2)
sqrt(1.395*B[3,3])
# cov(b2,b4)
1.395*B[3,5]
# cor(b2,b4)
(1.395*B[3,5])/((sqrt(1.395*B[3,3]))*(sqrt(1.395*B[5,5])))
```

(a) If MSE = 1.395 and n = 38 , compute the (Keep 4 or more decimal places, DO NOT round in the intermediate steps)

(i)   se(β ̂_4)

$$se(\mathbf{\hat\beta_4})=\sqrt{MSE\times C_{55}}=\sqrt{1.395\times0.069}=0.3102499$$

(ii)   Cov(β ̂_2,β ̂_4)

$$Cov(\mathbf{\hat\beta_2,\hat\beta_4})=MSE\times C_{35}=1.395\times(-0.035)=-0.048825$$

(iii)   Cor(β ̂_2,β ̂_4 )

$$se(\mathbf{\hat\beta_2})=\sqrt{MSE\times C_{33}}=\sqrt{1.395\times0.067}=0.3057205$$

$$Cor(\mathbf{\hat\beta_2,\hat\beta_4})=\frac{Cov(\mathbf{\hat\beta_2,\hat\beta_4})}{se(\mathbf{\hat\beta_2})se(\mathbf{\hat\beta_4})}=\frac{-0.048825}{0.3057205\times0.3102499}=-0.5147615$$

(iv) Without computing anything, explain which estimator is the most consistent.

$C_{66}=0.058$ has the smallest value. $\hatβ_5$ has the the least variance and the most consistent among the estimators.

(v) Without computing anything , list the pair(s) of estimators that are positively correlated. Provide a reason.

According to the $(X'X)^{(-1)}$,

$C_{13},\ C_{17},\ C_{24},\ C_{25},\ C_{67}$ are positive. 

The positively correlated pairs of parameters are

$\hatβ_0$ and $\hatβ_2$, 
$\hatβ_0$ and $\hatβ_6$, 
$\hatβ_1$ and $\hatβ_3$, 
$\hatβ_1$ and $\hatβ_4$, 
$\hatβ_5$ and $\hatβ_6$.


(b) Consider the following hypothesis: $H_0:  β_1=2β_3,β_2=β_3,β_5=0$

(i)  Report the T matrix, β vector and c vector along with their dimensions, and the rank of T matrix for testing the above hypothesis.

$$
\mathbf{T}=\begin{bmatrix} 0 & 1 & 0 & -2 & 0 & 0& 0 \\ 0 & 0 & 1 & -1 & 0 & 0 & 0\\ 0 & 0 & 0 & 0 & 0 & 1 & 0 \end{bmatrix}_{3\times7} 
\mathbf{β}=\begin{bmatrix} \beta_0 \\ \beta_1 \\ \beta_2 \\ \beta_3 \\ \beta_4 \\ \beta_5 \\ \beta_6 \end{bmatrix}_{7\times1}
\mathbf{C}=\begin{bmatrix} 0 \\ 0 \\ 0\end{bmatrix}_{3\times1} rank(T)=3
$$

(ii) Report the values of numerator and denominator degrees of freedom for the corresponding F test.
For F test, the numerator is MSR while denominator is MSE, thus

In this hypothesis,$y=β_0+2β_3x_1+β_3x_2+β_3x_3+β_4x_4+0x_5+β_6x_6+ε=β_0+β_3(2x_1+x_2+x_3)+β_4x_4+β_6x_6+ε$


The value of numerator is $r=df_{Reduced}-df_{Full}=n-(3+1)-[n-(6+1)]=3$

The denominator degrees of freedom is $df_{Full}=n-(k+1)=38-(6+1)=31$

(c) Show the following equation is an alternative form of the sum of squares of regreesion or model (SSR).

$$SSR=\sum_{i=1}^n(\hat y_i-\bar y)^2=\sum_{i=1}^n(\hat y_i^2-2\hat y_i\bar y+\bar y^2)=\sum_{i=1}^n\hat y_i^2-2\bar y\sum_{i=1}^n\hat y_i+\sum_{i=1}^n\bar y^2$$

$$=\sum_{i=1}^n\hat y_i^2-2\bar yn\frac{\sum_{i=1}^n\hat y_i}n+n\bar y^2=\sum_{i=1}^n\hat y_i^2-2\bar yn\bar y+n\bar y^2=\sum_{i=1}^n\hat y_i^2-n\bar y^2$$

### Question 2 (Use software to analyze the given data)

The data in the WaterFlow file are simulated data on peak rate of flow (in cfs) of water from six watersheds following storm episodes. The predictors are:

x1 : Area of watershed (mi2) 
x2 : Area impervious to water (mi2)  
x3 : Average slope of watershed (percent)   
x4 : Longest stream flow in watershed (1000s of feet)  
x5 : surface absorbency index, (0= complete absorbency, 100=no absorbency)  
x6 : estimated soil storage capacity (inches of water)   
x7 : Infiltration rate of water into soil (inches/hour)  
x8 : Rainfall (inches)   
x9 : Time period during which rainfall exceeded ¼ inch/hour  

(a) Create the matrix of scatterplots and compute the correlation matrix for all the variables. Copy and paste them here.

```{r echo=FALSE, fig.height=8, fig.width=12}
library(tidyverse)
table_wf <- read_table2("WaterFlow.txt")
library(GGally)
ggpairs(data=table_wf[c(1:10)])

```

****

(b) Based on scatterplots and correlation, explain which predictors are significantly related to (most likely to contribute to the variation in) the response variable.

Based on scatterplots and correlation, **X2(0.666),X7(0.668),X1(0.781),X4(0.866)** have medium to strong positive linear relationship to the response variable (Correlation coefficient is more than 0.6). **X5(-0.62)** have medium negative linear relationship to the response variable.

****

(c) Fit the full model.

$$\hat y=292.561-203.144X_1+ 1055.782X_2-49.24X_3+209.762X_4-10.197X_5-24.558X_6+142.778X_7+511.713X_8-301.872X_9$$

****

(i) Explain whether the overall model is significant at 5% significance level.

The fitted model is statistically significant at 5% significance level ($p-value=9.744\times^{-06}$). But most of the coefficients are not significent. This model is not the best fitted model.

****

(ii) Explain whether assumptions of random errors and model are satisfied. If there is a violation of those, then suggest reasonable methods to correct them.

- Residual Diagnostics: Use plots to examine residuals to validate OLS assumptions

There is some violation of assumptions about the errors: 

On the residual plot, there is a **funnel pattern**.

On the outlier and leverage plot, there are **two outliers**.

On the qq plot, most of points follow approximately straight line but have some **positive skew**. 

- Suggestion: Transform and other diagnostics.

I suggest using **natural log of response** to make a variance-stabilizing transformations. 

Other diagnostics of heteroskedasticity, variable selection, measures of influence also should be considered.

****

(iii) How much of the sum of squares is explained by rainfall, given that all the other regression coefficients are in the model?

Accroding to the  F test, the partial sum of squares explained by rainfall is **2209825**, given that all the other regression coefficients are in the model.

****

(iv) Explain whether there is a problem of multicollinearity.

- Collinearity diagnostics: 

The model does have **serious problems of multicollinearity**. The VIF of variables **X4 (105.754708), X1 (101.859709), X3 (31.446394), X7(20.53505)** are larger than 10. 

****

(v) Interpret the estimated coefficient of rainfall predictor of the full model using question context.

Coefficient of 511.713 suggests the peak rate of flow increases by **511.713** cubic feet per second when the rainfall increases by 1 inch and other variables are constants. 

****

(d) Create a new variable using natural log of response. Then fit the full model using this new variable as response.

$$log(\hat y)=3.402256-0.013532X_1-1.023664X_2+0.177966X_3+0.108788X_4$$
$$-0.009622X_5-0.389474X_6+4.233475X_7+0.63007X_8-0.462276X_9$$

(1) Explain whether the overall model is significant at 5% significance level.

The fitted model is statistically significant at 5% significance level ($p-value=7.513\times10^{-11}$). But most of the coefficients are not significent. This model is not the best fitted model.

****

(2) Explain whether there is a problem of multicollinearity.

The model still has serious problems of multicollinearity. The variance-stabilizing transformations does not change the value of VIF.  

It will be important to solve multicollinearity. However, X7 (20.53505), X1 (101.859709), and X4 (105.754708) have medium to strong positive linear relationship to the response variable. It is also dangerous to remove these variables. We should have more diagnostics and comparisons.

****

(3) If you wanted to simplify this full model, explain which predictor you would eliminate first.

- VIF

If just considering the VIF, X4 (105.754708) or X1 (101.859709) with largest VIF values is the first to remove. 

- Correlation with y

However, according to the correlation coefficients, both X4and X1 is strongly correlated with y ($Cor_{y,x_4}=0.866,Cor_{y,x_1}=0.781$) . 

The textbook suggest that the general approaches for dealing with multicollinearity include collecting additional data, model respecification (redefine the regressors, variable elimination), estimation methods (Ridge Regression, Principal-Component Regression). "Variable elimination is often a highly effective technique. However, it may not provide a satisfactory solution if the regressors dropped from the model have significant explanatory power relative to the response y. That is, eliminating regressors to reduce multicollinearity may damage the predictive power of the model." (Montgomery et al., 2012. p.304) In this way, the third multicollinear X3(31.446394) with a weak relationship with y (0.205) should be removed, or even X6(0.0453).

- Correlation with each other

According to the variable names of X4, X1, and X3, they are geographic variables. Predictor X1 is the area of watershed while X4 is the longest stream flow in watershed, x3 is the average slope of watershed. For the given 6 watersheds, X1 and X4 are strongly related. A high correlation (0.921) is expected between these two variables. But X3 is not significently related with X1(-0.078) or X4(0.245). Removing X3 might lose some irreplacable infromation. I

Actrually, I don't agree remove any predictor in this stage. Removing any predictor can draw down the VIF significently. After elimination regression, the multicollinearity dissapeared in all the models. We should gather sufficient evidents before removing any predictor.


****

(4) Use the forward selection method to find the best model (use α=0.15) and report the final fitted model with estimated coefficients here.

Use Stepwise Forward Regression based on p values (use α=0.15)

$$\hat y=2.872+0.168X_3+0.122X_4+3.106X_7$$

Use Stepwise AIC Forwardd Regression

$$\hat y=2.692+0.184X_3+0.109X_4-0.368X_6+4.085X_7+0.612X_8-0.448X_9$$

****

(5) Use the backward elimination method to find the best model (use α=0.05) and report the final fitted model with estimated coefficients here.

Stepwise Backward Regression based on p values (use α=0.05) and Stepwise AIC Backward Regression have same results.

$$\hat y=2.692+0.184X_3+0.109X_4-0.368X_6+4.085X_7+0.612X_8-0.448X_9$$

****

(6) Use best subsets method (6 models from each size) to find the best model for these data and report the final fitted model with estimated coefficients here.

Best subsets method gives a same model.

$$\hat y=2.692+0.184X_3+0.109X_4-0.368X_6+4.085X_7+0.612X_8-0.448X_9$$

***

(7) If the final models in the previous 3 methods are different, compare their model adequacy and suggest one best model.

|      Method     |	  By  |      	Keep       |	Remove
|-----------------| ------ | ------------------| ----
Stepwise Forward  |	P=0.15| X3, X4, X7	     | X1,X2,X5,X6,X8,X9
Stepwise Forward  |	AIC   | X3,X4,X6,X7,X8,X9 | X1,X2,X5
Stepwise Backward	| P=0.05 | X3,X4,X6,X7,X8,X9 | X1,X2,X5
Stepwise Backward	| AIC    | X3,X4,X6,X7,X8,X9 | X1,X2,X5
Stepwise Both	   | P	   | X3, X4, X7	     | X1,X2,X5,X6,X8,X9
Stepwise Both	   | AIC	   | X3,X4,X6,X7,X8,X9 | X1,X2,X5
Best Subset	      |	  /   | X3,X4,X6,X7,X8,X9 | X1,X2,X5
all possible      |	  /   | X3,X4,X6,X7,X8,X9 | X1,X2,X5

Both models solved the problem of multicollinearity (VIF <10), and small P-values for F test. They don't have serious violation of assumptions about the errors (There is no significant pattern on the plot of studentized residuals versus predicted values from the model with only one predictor. The partial regression plots do not show nonlinear patterns. The points follow approximately straight line on the qq plot). Both of Correlation between observed residuals and expected residuals under normality.The 6-predictor model got 0.9837263 P-value while the 6-predictor model got 0.9856766. 

|    Model  | VIF |   F  |P-value(F)| MSR  | MSE |$R_{adjusted}^2$|$R_{Predict}^2$|P-value(t)| Residuals Plots 
|----       |---- |----  | ----     | ---- | ----| ----           | ----          | ----     | ----
3-4-7       | <10 |70.378|0.0000    |21.188|0.301| 0.878          | 0.854         |Max=0.054 | Good enough
3-4-6-7-8-9 | <10 |68.16 |0.0000	   |11.265|0.165| 0.933          | 0.908         |Max=0.019 | Good enough

However, comparing to the 3-variable model, the 6-variable model has a higher (about by 6%) adjusted R square and higher (about by 5%) prediction R-square, which means it shows stronger predictive capability. All the coeficients in 6-predictors model are statistically significant higher than 98% significance level (the maximum p-values are 0.019, respectively). In the 3-variable model, X7 get a high p-value (0.054) which means not significant at 5% significance level. If we change the p-value as the parameter of forward selection, the same model will happened between $\alpha$ equal 0.6 and 0.17. 
Further, considering the context, X8 and X9 are variables of precipitation. The 3-predictor model mean the peak flow is irrelevant with precipitation. It doesn't make sense. Therefore, the best model will be the model with 6 predictors.

****

(8) Provide complete ANOVA table for the best model. Provide partial sum of squares, estimated coefficients, standard errors, p-values, 95% Bonferroni joint confidence intervals for the coefficients of the best model. Provide in a tabular form clearly.

| Model Summary | 
|---------------|----------------|--------------------------------|----
|R              |        0.973   |   RMSE (Root Mean Square Error)|0.407
|R-Squared      |        0.947   |   Coef. Var                    |6.385
|Adj. R-Squared |        0.933   |   MSE (Mean Square Error)      |0.165
|Pred R-Squared |        0.908   |   MAE (Mean Absolute Error)    |0.273


|   ANOVA   |                |
|-----------|----------------|---|---------------|--------|---------
|           |  Sum of Squares|DF |  Mean Square  |   F    | p-value 
|Regression |   67.591       | 6 |       11.265  |  68.16 |$1.717\times10^{-13}$
|Residual   |    3.801       |23 |        0.165  |                  
|Total      |   71.393       |29 |               |                  

 
| Parameter |Estimates             |                 
|-----------|----------------------|----------|-----------|-------|-------------------|-----------|---------
|      model|Estimated coefficients|Partial SS|Std. Error |t test | p-value           |   2.5 %   |   97.5 % 
|(Intercept)|      2.69180         |     /    |     0.445 | 6.046 |$3.63\times10{-06}$| 1.77080533| 3.61278901
|         X3|      0.18384         |    5.37  |     0.032 | 5.698 |$8.41\times10{-06}$| 0.11709482| 0.25059326
|         X4|      0.10905         |    2.98  |     0.026 | 4.244 |     0.000306      | 0.05589763| 0.16220302
|         X6|     -0.36752         |    1.05  |     0.146 |-2.526 |     0.018898      |-0.66855123| -0.06648201
|         X7|      4.08497         |    1.87  |     1.213 | 3.367 |     0.002662      | 1.57533753| 6.59460252
|         X8|      0.61161         |    3.52  |     0.133 | 4.614 |     0.000122      | 0.33738118| 0.88582991
|         X9|     -0.44764         |    2.83  |     0.108 |-4.135 |     0.000402      |-0.67159465|-0.22368135


****

(9) How much variation in the response is explained by the best model after taking number of data and regression coefficients in to account?

By SSR equal 67.591 and SSE equal 3.801, the adjusted R-squared is 0.9329. About **93.29%** variation in the response is explained by the best model.

****

(10) Report the PRESS statistic of the best model.

The value of PRESS is **6.538275**. This model explains **90.8%** of variation in predicting the peak rate of flow (in cfs) of water from six watersheds following storm episodes.

****

(e) Report the complete code along with output here.


 Singh (1972) used linear models with a logarithm transformation of the variables. We retained the following
where the dependent variables can either be total storm flow volume (Qt) in mm, quick flow volume (Qf) in mm or peak flow (Qpk) in m3 sec−1 km−2. Independent variables were storm rainfall (P) in mm, initial flow (Qi) in mm h−1, rainfall frequency (Fp), the inverse of rainfall duration, in h−1 and a dummy variable (CC) representing the treatment effect on basin 7A. CC was 0 and 1 for the calibration (1967–1992) and treated (1994–1998) periods, respectively. β0 to β4 are regression coefficients of the independent variables. All interactions between the independent variables were also tested for significance at α=0.10.

$$ln(Dependent\ Variable)=β_0+β_1lnP+β_2lnQ+β_3lnFP+β_4CC+Interactions+\varepsilon$$

The significance of the regression coefficients (being different from 0) in the models has been tested with a t-test procedure at α=0.10 using the GLM procedure of the SAS system for Windows (SAS Institute, Inc., 1989). A regression coefficient significantly different from 0 for the variable CC indicates that the treatment had a significant effect on the dependent variable. Normality of residuals has been tested using the Shapiro–Wilk test. Selection criteria for all events were the same as for the paired basins approach. However, the rainfall events following night-frost, which may caused localized surface runoff on ice as observed by Prevost et al. (1990), were omitted since these events are too rare to be well represented during the calibration and post-treatment periods. Hence, all events within three weeks following the end of the snowmelt period were not retained. The end of the snowmelt period was obtained from observations in a standard forest snow line at Montmorency Forest. (Guillemette et al., 2005)



- Residual Diagnostics: 

Includes plots to examine residuals to validate OLS assumptions

There is no violation of assumptions about the errors (no pattern on residual plots and points follow approximately straight line on the qq plot). 

- Variable selection: 

Differnt variable selection procedures such as all possible regression, best subset regression, stepwise regression, stepwise forward regression and stepwise backward regression

- Heteroskedasticity: 

Tests for heteroskedasticity include bartlett test, breusch pagan test, score test and f test

- Measures of influence: 

Use different plots to detect and identify influential observations


- Collinearity diagnostics: 

VIF, Tolerance and condition indices to detect collinearity and plots for assessing mode fit and contributions of variables


x1 : Area of watershed (mi2)  
x8 : Rainfall (inches)   

x9 : Time period during which rainfall exceeded ¼ inch/hour  
x4 : Longest stream flow in watershed (1000s of feet)  

x3 : Average slope of watershed (percent)  


x2 : Area impervious to water (mi2)  
x5 : surface absorbency index, (0= complete absorbency, 100=no absorbency)  
x7 : Infiltration rate of water into soil (inches/hour)  
x6 : estimated soil storage capacity (inches of water)  

Full model

eliminated model

- Residual Diagnostics: 

Includes plots to examine residuals to validate OLS assumptions

There is no violation of assumptions about the errors (no pattern on residual plots and points follow approximately straight line on the qq plot). 

Residual QQ Plot
Residual Normality Test
Residual vs Fitted Values Plot
Residual Histogram

- Variable selection: 

Differnt variable selection procedures such as all possible regression, best subset regression, stepwise regression, stepwise forward regression and stepwise backward regression

- Heteroskedasticity: 

Tests for heteroskedasticity include bartlett test, breusch pagan test, score test and f test

Bartlett Test
Breusch Pagan Test
Score Test
F Test

- Measures of influence: 

Use different plots to detect and identify influential observations

Cook’s D Bar Plot
Cook’s D Chart
DFBETAs Panel
DFFITs Plot
Studentized Residual Plot
Standardized Residual Chart
Studentized Residuals vs Leverage Plot
Deleted Studentized Residual vs Fitted Values Plot
Hadi Plot
Potential Residual Plot

[1]: Montgomery, D. C., Peck, E. A., & Vining, G. G. (2012). Introduction to linear regression analysis (Vol. 821). John Wiley & Sons.

[2]: Guillemette, F., Plamondon, A. P., Prévost, M., & Lévesque, D. (2005). Rainfall generated stormflow response to clearcutting a boreal forest: peak flow comparison with 50 world-wide basin studies. Journal of hydrology, 302(1-4), 137-153.


## 

#### (a) The matrix of scatterplots and the correlation matrix

```{r , eval=F, include = T}
library(tidyverse)
table_wf <- read_table2("WaterFlow.txt")
library(GGally)
ggpairs(data=table_wf[c(1:10)])
```

```{r, eval=T, include = F}
# Load the package 
library(olsrr)
library(car)
# Import Data
table_wf <- read_table2("WaterFlow.txt")
```

#### (c) The fitted full model

```{r, eval=T, include = T}
# build the model
model_wf_full <- lm(y ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_full%>% summary()
Anova(model_wf_full)

```

#### (c) ii Residual diagnostics

```{r, eval=T, include = T}
#Model Fit Assessment
ols_plot_diagnostics(model_wf_full)

# Part & Partial Correlations
ols_test_correlation(model_wf_full) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_full) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

```

#### (c) iii The partial regression and nonlinear diagnostics

```{r, eval=T, include = T}
#Lack of Fit F Test
ols_pure_error_anova(lm(y~X8, data = table_wf))

# Variable Contributions
ols_plot_added_variable(model_wf_full)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_full)
```

#### (c) iv Collinearity diagnostics

```{r, eval=T, include = T}
# for full model
ols_vif_tol(model_wf_full)

```

#### (d)  The fitted log model

```{r, eval=T, include = T}
# build full log model
model_wf_full_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9, data=table_wf)
summary(model_wf_full_log)
Anova(model_wf_full)

#Model Fit Assessment
# ols_plot_diagnostics(model_wf_full_log)

# Part & Partial Correlations
# ols_test_correlation(model_wf_full_log) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
# ols_test_normality(model_wf_full_log) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #
library(dplyr)
```

#### (d) (2) Collinearity diagnostics

```{r , eval=T, echo=F, include = T}
library(MASS)
# remove 1-9
model_wf_rm1_log <- lm(log(y) ~ X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_rm2_log <- lm(log(y) ~ X1 + X3 + X4 + X5 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_rm3_log <- lm(log(y) ~ X1 + X2 + X4 + X5 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_rm4_log <- lm(log(y) ~ X1 + X2 + X3 + X5 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_rm5_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X6 + X7 + X8 + X9, data=table_wf)
model_wf_rm6_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X5 + X7 + X8 + X9, data=table_wf)
model_wf_rm7_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X5 + X6 + X8 + X9, data=table_wf)
model_wf_rm8_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X9, data=table_wf)
model_wf_rm9_log <- lm(log(y) ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8, data=table_wf)

# AIC elimination
model_wf_aic_log <- stepAIC(model_wf_full_log)
model_wf_rm1_aic_log <- stepAIC(model_wf_rm1_log)
model_wf_rm2_aic_log <- stepAIC(model_wf_rm2_log)
model_wf_rm3_aic_log <- stepAIC(model_wf_rm3_log)
model_wf_rm4_aic_log <- stepAIC(model_wf_rm4_log)
model_wf_rm5_aic_log <- stepAIC(model_wf_rm5_log)
model_wf_rm6_aic_log <- stepAIC(model_wf_rm6_log)
model_wf_rm7_aic_log <- stepAIC(model_wf_rm7_log)
model_wf_rm8_aic_log <- stepAIC(model_wf_rm8_log)
model_wf_rm9_aic_log <- stepAIC(model_wf_rm9_log)
```

```{r, eval=T, include = T}
# Compare vif
ols_vif_tol(model_wf_full_log)
ols_vif_tol(model_wf_aic_log)
ols_vif_tol(model_wf_rm1_log)
ols_vif_tol(model_wf_rm1_aic_log)
ols_vif_tol(model_wf_rm2_log)
ols_vif_tol(model_wf_rm2_aic_log)
ols_vif_tol(model_wf_rm3_log)
ols_vif_tol(model_wf_rm3_aic_log)
ols_vif_tol(model_wf_rm4_log)
ols_vif_tol(model_wf_rm4_aic_log)
ols_vif_tol(model_wf_rm5_log)
ols_vif_tol(model_wf_rm5_aic_log)
ols_vif_tol(model_wf_rm6_log)
ols_vif_tol(model_wf_rm6_aic_log)
ols_vif_tol(model_wf_rm7_log)
ols_vif_tol(model_wf_rm7_aic_log)
ols_vif_tol(model_wf_rm8_log)
ols_vif_tol(model_wf_rm8_aic_log)
ols_vif_tol(model_wf_rm9_log)
ols_vif_tol(model_wf_rm9_aic_log)
```


#### (d) (3) Variable selection

```{r, eval=T, include = T}
library(huxtable)
huxreg(model_wf_rm1_log, model_wf_rm2_log, model_wf_rm3_log, model_wf_rm4_log, model_wf_rm5_log, model_wf_rm6_log, model_wf_rm7_log, model_wf_rm8_log, model_wf_rm9_log, model_wf_full_log)

huxreg(model_wf_rm1_aic_log, model_wf_rm2_aic_log, model_wf_rm3_aic_log, model_wf_rm4_aic_log, model_wf_rm5_aic_log, model_wf_rm6_aic_log, model_wf_rm7_aic_log, model_wf_rm8_aic_log, model_wf_rm9_aic_log, model_wf_aic_log)

```

#### (d) (4) Forward selection 

Stepwise Forward Regression for full model

```{r, eval=F, include = T}
# Stepwise Forward Regression based on p values (use a=0.15) #
ols_step_forward_p(model_wf_full_log, penter = 0.15)

# Stepwise AIC Forward Regression #
ols_step_forward_aic(model_wf_full_log)

```

Stepwise Forward Regression for X4 eliminated model

```{r, eval=F, include = T}
# Stepwise Forward Regression based on p values (use a=0.15) #
ols_step_forward_p(model_wf_rm4_log, penter = 0.15)
# Stepwise AIC Forward Regression #
ols_step_forward_aic(model_wf_rm4_log)
```

Stepwise Forward Regression for X1 eliminated model

```{r, eval=F, include = T}
# Stepwise Forward Regression based on p values (use a=0.15) #
ols_step_forward_p(model_wf_rm1_log, penter = 0.15)
# Stepwise AIC Forward Regression #
ols_step_forward_aic(model_wf_rm1_log)
```

#### (d) (5) Backward selection 

Stepwise Backward Regression for full model

```{r, eval=T, include = T}
# Stepwise Backward Regression based on p values (use a=0.05) #
ols_step_backward_p(model_wf_full_log, penter = 0.05)
# Stepwise AIC Backward Regression #
ols_step_backward_aic(model_wf_full_log)
```

Stepwise Backward Regression for X4 eliminated model

```{r, eval=F, include = T}
# Stepwise Backward Regression based on p values (use a=0.05) #
ols_step_backward_p(model_wf_rm4_log, penter = 0.05)
# Stepwise AIC Backward Regression #
ols_step_backward_aic(model_wf_rm4_log)
```

Stepwise Backward Regression for X1 eliminated model

```{r, eval=F, include = T}
# Stepwise Backward Regression based on p values (use a=0.05) #
ols_step_backward_p(model_wf_rm1_log, penter = 0.05)
# Stepwise AIC Backward Regression #
ols_step_backward_aic(model_wf_rm1_log)

```

#### (d) (6) Best Subset Regression

```{r echo=TRUE}
# For full model #
k <- ols_step_best_subset(model_wf_full_log)
k
plot(k)

# For X4 eliminated model #
# k <- ols_step_best_subset(model_wf_rm4_log)
# k
# plot(k)

# For X1 eliminated model #
# k <- ols_step_best_subset(model_wf_rm1_log)
# k
# plot(k)

```

#### (d) (7) Models Comparison

- Model 437896

```{r, eval=T, include = T}
# build model 437896
model_wf_437896_log <- lm(log(y) ~ X4 + X3 + X7 + X8 + X9 + X6, data=table_wf)
ols_regress(model_wf_437896_log)
confint(model_wf_437896_log, level=0.95/1) # Bonferroni joint confidence interval #

# Collinearity Diagnostics #
ols_vif_tol(model_wf_437896_log)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_437896_log)

# Part & Partial Correlations
ols_test_correlation(model_wf_437896_log) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_437896_log) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_437896_log)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_437896_log)

```

- Model 437

```{r, eval=T, include = T}
# build model 437
model_wf_437_log <- lm(log(y) ~ X4 + X3 + X7, data=table_wf)
ols_regress(model_wf_437_log)

# Collinearity Diagnostics #
ols_vif_tol(model_wf_437_log)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_437_log)

# Part & Partial Correlations
ols_test_correlation(model_wf_437_log) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_437_log) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_437_log)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_437_log)

```

- Model 137689

```{r, eval=T, include = T}
# build model 137689
model_wf_137689_log <- lm(log(y) ~ X1 + X3 + X7 + X6 + X8 + X9, data=table_wf)
ols_regress(model_wf_137689_log)

# Collinearity Diagnostics #
ols_vif_tol(model_wf_137689_log)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_137689_log)

# Part & Partial Correlations
ols_test_correlation(model_wf_137689_log) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_137689_log) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_137689_log)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_137689_log)

```


```{r, eval=T, include = T}
# Check PRESS Statistic
ols_press(model_wf_full)
ols_press(model_wf_full_log)
ols_press(model_wf_437896_log)
ols_press(model_wf_437_log)
ols_press(model_wf_137689_log)

# prediction power
ols_pred_rsq(model_wf_full)
ols_pred_rsq(model_wf_full_log)
ols_pred_rsq(model_wf_437896_log)
ols_pred_rsq(model_wf_437_log)
ols_pred_rsq(model_wf_137689_log)

```

#### More

- Other Models

```{r, eval=F, include = T}

# build X1*X8 eliminated log model
model_wf_18rm4_log <- lm(log(y) ~ X1*X8 + X3 + X6 + X7 + X9, data=table_wf)

# build X1*X8 eliminated log model
table_wf_resi <- table_wf%>% mutate(x1t8=X1*X8)
model_wf_1time8_log <- lm(log(y) ~ x1t8 + X3 + X6 + X7+ X9 , data=table_wf_resi)

# build X1*X4 eliminated log model
table_wf_resi <- table_wf%>% mutate(x1t4=X1*X4)
model_wf_1time4_log <- lm(log(y) ~ x1t4 + X3 + X6 + X7+ X8+ X9, data=table_wf_resi)
summary(model_wf_1time4_log)

# build X1/X4 eliminated log model
table_wf_resi <- table_wf%>% mutate(x14=X1/X4)
model_wf_1per4_log <- lm(log(y) ~ x14 + X3 + X6 + X7+ X8+ X9, data=table_wf_resi)

# build X4*X3 eliminated log model
model_wf_43rm1_log <- lm(log(y) ~ X9 + X4*X3 + X6 + X7 + X8 , data=table_wf)

# build X4*X9 eliminated log model
model_wf_49rm1_log <- lm(log(y) ~ X3 + X4*X9 + X6 + X7 + X8 , data=table_wf)

# build X4*X9 eliminated log model
model_wf_48rm1_log <- lm(log(y) ~ X3 + X4*X8 + X6 + X7 + X9 , data=table_wf)

# build X4*X9 eliminated log model
model_wf_47rm1_log <- lm(log(y) ~ X3 + X4*X7 + X6 + X9 + X8 , data=table_wf)

# build X4/X9 eliminated log model
table_wf_resi <- table_wf%>% mutate(x4p9=X4/X9)
model_wf_4per9_log <- lm(log(y) ~ X3 + x4p9 + X6 + X7 + X8 , data=table_wf_resi)

# build X3/X4vX8*X9 eliminated log model
model_wf_34v89_log <- lm(log(y) ~ X3*X4 + X8*X9 + X6 + X7, data=table_wf_resi)

# build X3/X4vX8*X9 eliminated log model
model_wf_34v89v67_log <- lm(log(y) ~ X3*X4 + X8*X9 + X6*X7, data=table_wf_resi)

# build X8/X9vX4*X3 eliminated log model
table_wf_resi <- table_wf%>% mutate(x8p9=X8/X9)
model_wf_8per9v43_log <- lm(log(y) ~ x8p9 + X4*X3 + X6 + X7, data=table_wf_resi)

# build X6/7vX8/X9vX4X3 eliminated log model
table_wf_resi <- table_wf%>% mutate(x8p9=X8/X9,x6p7=X6/X7)
model_wf_6p7v8p9v43_log <- lm(log(y) ~ x8p9 + X4*X3 + x6p7, data=table_wf_resi)

# build X8/X9vX4*X3rmX7 eliminated log model
table_wf_resi <- table_wf%>% mutate(x8p9=X8/X9)
model_wf_8per9v43rm7_log <- lm(log(y) ~ x8p9 + X4*X3 + X6, data=table_wf_resi)

# build X8/X9vX4*X3vX6/X7 eliminated log model
table_wf_resi <- table_wf%>% mutate(x8p9=X8/X9)
model_wf_8per9v43rm7_log <- lm(log(y) ~ x8p9 + X4*X3 + X6, data=table_wf_resi)

huxreg(model_wf_8per9v43rm7_log, model_wf_8per9v43_log, model_wf_43rm1_log, model_wf_6p7v8p9v43_log, model_wf_34v89_log, model_wf_34v89v67_log)
```

- Interaction models

```{r, eval=T, include = T}
# Interaction regression for full
model_wf_full_log_inter <- lm(log(y)~ (X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_aic_log_inter <- stepAIC(model_wf_full_log_inter)

```

```{r, eval=F, include = T}
# Interaction regression for remove X1-9
model_wf_rm1_log_inter <- lm(log(y) ~ (X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_rm1_aic_log_inter <- stepAIC(model_wf_rm1_log_inter)
model_wf_rm2_log_inter <- lm(log(y) ~ (X1 + X3 + X4 + X5 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_rm2_aic_log_inter <- stepAIC(model_wf_rm2_log_inter)
model_wf_rm3_log_inter <- lm(log(y) ~ (X1 + X2 + X4 + X5 + X6 + X7+ X8 + X9)^2, data=table_wf)
model_wf_rm3_aic_log_inter <- stepAIC(model_wf_rm3_log_inter)
model_wf_rm5_log_inter <- lm(log(y) ~ (X1 + X2 + X3 + X4 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_rm5_aic_log_inter <- stepAIC(model_wf_rm5_log_inter)
model_wf_rm4_log_inter <- lm(log(y) ~ (X1 + X2 + X3 + X5 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_rm4_aic_log_inter <- stepAIC(model_wf_rm4_log_inter)
model_wf_rm6_log_inter <- lm(log(y) ~ (X2 + X3 + X1 + X5 + X4 + X7 + X8 + X9)^2, data=table_wf)
model_wf_rm6_aic_log_inter <- stepAIC(model_wf_rm6_log_inter)
model_wf_rm7_log_inter <- lm(log(y) ~ (X1 + X2 + X3 + X4 + X5 + X6 + X8 + X9)^2, data=table_wf)
model_wf_rm7_aic_log_inter <- stepAIC(model_wf_rm7_log_inter)
model_wf_rm8_log_inter <- lm(log(y) ~ (X1 + X2 + X3 + X4 + X5 + X6 + X7 + X9)^2, data=table_wf)
model_wf_rm8_aic_log_inter <- stepAIC(model_wf_rm8_log_inter)
model_wf_rm9_log_inter <- lm(log(y) ~ (X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8)^2, data=table_wf)
model_wf_rm9_aic_log_inter <- stepAIC(model_wf_rm9_log_inter)

# Interaction regression for 136789
model_wf_136789_log_inter <- lm(log(y) ~ (X3 + X1 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_136789_aic_log_inter <- stepAIC(model_wf_136789_log_inter)
# Interaction regression for 436789
model_wf_436789_log_inter <- lm(log(y) ~ (X3 + X4 + X6 + X7 + X8 + X9)^2, data=table_wf)
model_wf_436789_aic_log_inter <- stepAIC(model_wf_436789_log_inter)
# Interaction regression for 437
model_wf_437_log_inter <- lm(log(y) ~ (X3 + X4 + X7 )^2, data=table_wf)
model_wf_437_aic_log_inter <- stepAIC(model_wf_437_log_inter)

# Interaction regression for 489
model_wf_489_log_inter <- lm(log(y) ~ (X4 + X8 + X9 )^2, data=table_wf)
model_wf_489_aic_log_inter <- stepAIC(model_wf_489_log_inter)

# Interaction regression by groups
model_wf_3g_log_inter <- lm(log(y) ~ (X1 + X3 + X4 )^2 + (X2+ X5+X6 + X7)^2 + (X8 + X9)^2, data=table_wf)
model_wf_3g_aic_log_inter <- stepAIC(model_wf_3g_log_inter)

# Interaction regression by groups1
model_wf_3g1_log_inter <- lm(log(y) ~ (X1 + X2 + X5 )^2 + (X3 +X6 + X7)^2 + (X4 +X8 + X9)^2, data=table_wf)
model_wf_3g1_aic_log_inter <- stepAIC(model_wf_3g1_log_inter)

# Comparison
huxreg(model_wf_rm1_aic_log_inter, model_wf_rm2_aic_log_inter, model_wf_rm3_aic_log_inter, model_wf_rm4_aic_log_inter, model_wf_rm5_aic_log_inter, model_wf_rm6_aic_log_inter, model_wf_rm7_aic_log_inter, model_wf_rm8_aic_log_inter, model_wf_rm9_aic_log_inter, model_wf_aic_log_inter)

huxreg(model_wf_136789_aic_log_inter,model_wf_436789_aic_log_inter, model_wf_437_log_inter, model_wf_489_log_inter, model_wf_3g_aic_log_inter, model_wf_3g1_aic_log_inter)

```


- All log models

```{r, eval=T, include = T}

# build all log model
model_wf_all_log <- lm(log(y) ~ log(X1) + log(X2) + log(X3) + log(X4) + log(X5) + log(X6) + log(X7) + log(X8) + log(X9), data=table_wf)
ols_vif_tol(model_wf_all_log)
model_wf_aic_all_log <- stepAIC(model_wf_all_log)
ols_vif_tol(model_wf_aic_all_log)

# Interaction regression for all log  model
model_wf_all_log_inter <- lm(log(y) ~ (log(X1) + log(X2) + log(X3) + log(X4) + log(X5) + log(X6) + log(X7) + log(X8) + log(X9))^2, data=table_wf)
model_wf_aic_all_log_inter <- stepAIC(model_wf_all_log_inter)

huxreg(model_wf_aic_log, model_wf_aic_all_log, model_wf_aic_log_inter, model_wf_aic_all_log_inter)
```

- Mixed models

```{r, eval=T, include = T}

# Mixed regression 1
model_wf_mix1 <- lm(log(y) ~ (X1 + X3 + X4 )^2 + log(X2+ X5+X6 + X7) + log(X8) + log(X9), data=table_wf)
model_wf_aic_mix1 <- stepAIC(model_wf_mix1)

# Mixed regression 2
model_wf_mix2 <- lm(log(y) ~ (X1 + X3 + X4 )^2 + log(X2)+log(X5)+log(X6)+log(X7) + log(X8) + log(X9), data=table_wf)
model_wf_aic_mix2 <- stepAIC(model_wf_mix2)

# Mixed regression 3
model_wf_mix3 <- lm(log(y) ~ (X1 + X3 + X4 )^2 + (log(X2)+log(X5)+log(X6)+log(X7))^2 + log(X8) + log(X9), data=table_wf)
model_wf_aic_mix3 <- stepAIC(model_wf_mix3)

huxreg(model_wf_aic_mix1, model_wf_aic_mix2, model_wf_aic_mix3)

```

#### Additional Steps

- step both

```{r , eval=T, include = T}

# Stepwise Regression based on p values for full model#
k <- ols_step_both_p(model_wf_full_log)
 k
# plot(k)

# Stepwise AIC Regression for full model#
k<- ols_step_both_aic(model_wf_full_log)
 k
# plot(k)

# Stepwise Regression based on p values for all log model #
k <- ols_step_both_p(model_wf_all_log)
k
#plot(k)

# Stepwise AIC Regression for all log model #
k <- ols_step_both_aic(model_wf_all_log)
k
# plot(k)

# Stepwise Regression based on p values for all log model #
k <- ols_step_both_p(model_wf_full_log_inter)
k
# plot(k)

# Stepwise AIC Regression for all log model #
k <- ols_step_both_aic(model_wf_full_log_inter)
k
# plot(k)

# Stepwise Regression based on p values for all log model #
k <- ols_step_both_p(model_wf_all_log_inter)
k
# plot(k)

# Stepwise AIC Regression for all log model #
k <- ols_step_both_aic(model_wf_all_log_inter)
k
# plot(k)

# Stepwise Regression based on p values for all log model #
k <- ols_step_both_p(model_wf_mix2 )
k
# plot(k)

k <- ols_step_both_aic(model_wf_mix2)
k
# plot(k)

# Stepwise Regression based on p values for X4 eliminated model#
# k <- ols_step_both_p(model_wf_rm4_log)
# k
# plot(k)

# Stepwise AIC Regression for X4 eliminated model#
# k<- ols_step_both_aic(model_wf_rm4_log)
# k
# plot(k)

# Stepwise Regression based on p values for X1 eliminated model#
# k <- ols_step_both_p(model_wf_rm1_log)
# k
# plot(k)

# Stepwise AIC Regression for X1 eliminated model#
# k<- ols_step_both_aic(model_wf_rm1_log)
# k
# plot(k)
```

```{r, eval=F, include = T}
# All Possible Regression for full log model #
k <- ols_step_all_possible(model_wf_full_log)
# plot(k)
head(arrange(k, desc(adjr)))

# All Possible Regression for all log model #
k <- ols_step_all_possible(model_wf_all_log)
# plot(k)
 head(arrange(k, desc(adjr)))

# All Possible Regression for 3g log model #
#!!!!!!!!!!!! k <- ols_step_all_possible(model_wf_3g_log_inter)
# plot(k)
# head(arrange(k, desc(adjr)))
 
# All Possible Regression for mixed log model #
# k <- ols_step_all_possible(model_wf_mix2 )
# plot(k)
#  head(arrange(k, desc(adjr)))

# All Possible Regression for X4 eliminated model #
# k <- ols_step_all_possible(model_wf_rm4_log)
# k
# plot(k)

# All Possible Regression for X1 eliminated model #
# k <- ols_step_all_possible(model_wf_rm1_log)
# k
# plot(k)

```


```{r, eval=F, include = T}

#Lack of Fit F Test

ols_pure_error_anova(lm(y~X1, data = table_wf))
ols_pure_error_anova(lm(y~X4, data = table_wf))

alias(lm(y ~ as.factor(X3) + as.factor(X4) + as.factor(X5) + as.factor(X6) + as.factor(X7), data=table_wf))

alias(lm(y ~ as.factor(X1) + as.factor(X8) , data=table_wf))

alias(lm(y ~ as.factor(X4) + as.factor(X9) , data=table_wf))

alias(lm(y ~ as.factor(X3) + as.factor(X6) + as.factor(X7) + as.factor(X8) + as.factor(X9) , data=table_wf))

```

#### Final models

- Check model aic_all_log

```{r, eval=T, include = T}
ols_regress(model_wf_aic_all_log )
summary(model_wf_aic_all_log)
Anova(model_wf_aic_all_log)

# Collinearity Diagnostics #
ols_vif_tol(model_wf_aic_all_log)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_aic_all_log)

# Part & Partial Correlations
ols_test_correlation(model_wf_aic_all_log) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_aic_all_log) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_aic_all_log)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_aic_all_log)
```

- Check model aic_log_inter

```{r, eval=T, include = T}

summary(model_wf_aic_log_inter)
Anova(model_wf_aic_log_inter)

# Collinearity Diagnostics #
ols_vif_tol(model_wf_aic_log_inter)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_aic_log_inter)

# Part & Partial Correlations
ols_test_correlation(model_wf_aic_log_inter) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_aic_log_inter) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_aic_log_inter)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_aic_log_inter)
```

- Check model mixed

```{r, eval=T, include = T}

summary(model_wf_aic_mix2 )
Anova(model_wf_aic_mix2 )

# Collinearity Diagnostics #
ols_vif_tol(model_wf_aic_mix2)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_aic_mix2)

# Part & Partial Correlations
ols_test_correlation(model_wf_aic_mix2) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_aic_mix2) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_aic_mix2)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_aic_mix2)
```

- Check model all log interaction

```{r, eval=T, include = T}
summary(model_wf_aic_all_log_inter)
Anova(model_wf_aic_all_log_inter)

# Collinearity Diagnostics #
ols_vif_tol(model_wf_aic_all_log_inter)

#Model Fit Assessment
ols_plot_diagnostics(model_wf_aic_all_log_inter)

# Part & Partial Correlations
ols_test_correlation(model_wf_aic_all_log_inter) # Correlation between observed residuals and expected residuals under normality.

# Residual Normality Test
ols_test_normality(model_wf_aic_all_log_inter) # Test for detecting violation of normality assumption. #If p-value is bigger, then no problem of non-normality #

# Variable Contributions
ols_plot_added_variable(model_wf_aic_all_log_inter)

# Residual Plus Component Plot
ols_plot_comp_plus_resid(model_wf_aic_all_log_inter)

```

