---
title: "STAT565 Lab"
author: ''
date: "Winter 2019"
output: html_document
---

#  {.tabset .tabset-fade .tabset-pills}

## Lab5 Two factor Factorial 1

An experiment was designed to study weight gain of rats fed four different diets, where there were two levels of protein (high or low) and two sources of protein (beef or cereal).  This gives 2 x 2 treatment combinations: high/beef (HB), high/cereal (HC), low/beef (LB), low/cereal (LC). Ten rats were in each of the four treatment groups. Use Î±=0.01

(a) Plot the data and report the plot here (A plot with data and means of treatment combinations). Do not report code here. Describe the observed relationship between two factors.


(b) Obtain the numerical summary for each treatment combination and factor levels separately. Report them here in a tabular form.


(c) Fit the two-factor factorial model and report the complete ANOVA table here. Do not report code here. The complete ANOVA table should have a row for each of the following: main effects of each treatment, two-factor interaction effects, error and total.

(d) Based on the ANOVA table write your conclusion appropriately. Perform all the necessary tests and report the conclusion along with the p-value.

(e) Provide the plots of residuals here. Do not report code here.


(f) Based on the residual plots, clearly explain whether assumptions in the model are satisfied or violated.


(g) Report the code here without output.

```{r eval=FALSE, include=FALSE}
install.packages("ggplot2")
install.packages("ggpubr")
install.packages("mosaic")
install.packages("agricolae")
install.packages("DescTools")
```

```{r include=FALSE}
library(readxl)
library(ggplot2)
library(ggpubr)
library(mosaic)
library(agricolae)
library(DescTools)
```

```{r, out.width='30%'}
table_protein <- read_excel("Protein.xlsx")
head(table_protein)

# Install and load ggplot2 package before using ggplot function #
ggplot(data = table_protein, aes(x = Amount, y = Gain, colour=Source, group=Source))+ 
  geom_point(aes(shape = Source,color = Source),size = 2) + 
  labs(y = "Weight Gained", x="Amount of table_protein", color ="Source of table_protein", shape ="Source of table_protein")

#Plots the Mean and 1SD error bars for each treatment group #
ggplot(data = table_protein, aes(x = Amount, y = Gain, colour=Source,shape = Source, group=Source)) +
  stat_summary() + labs(y= "Weight Gained", x="Amount of table_protein", color="Source", shape="Source")

# Install and load ggpubr package before using ggline function # 
ggline(data = table_protein, x = "Amount", y = "Gain", add = c("mean", "jitter"),shape= "Source",  color = "Source", linetype = "Source", ylab= "Weight Gained", xlab="Amount of table_protein")

#Load mosaic package before using favstats function#
favstats(Gain ~ Source, data=table_protein)
favstats(Gain ~ Amount , data=table_protein)
favstats(Gain ~ Source|Amount, data=table_protein)
#favstats(Gain ~ Source+Amount, data=table_protein)

#Create Categorical variables so that plot of residuals versus each treatment combination can be obtained using plot function with the fitted model later #
table_protein$Trt1 = as.factor(table_protein$Source)
table_protein$Trt2 = as.factor(table_protein$Amount)

model_protein <- aov(Gain ~ Trt1*Trt2, data=table_protein)
summary(model_protein)
plot(model_protein, pch=16)

# Pairwise comparisons using t tests with pooled Standard Deviation #
# The output gives a matrix of p values for each pair of treatments #
pairwise.t.test(table_protein$Gain, table_protein$Trt2, p.adj = "none") 

# Pairwise comparisons using t tests with pooled Standard Deviation and Bonferroni adjustment #
# The output gives a matrix of p values for each pair of treatments #
pairwise.t.test(table_protein$Gain, table_protein$Trt2, p.adj = "bonf")

#Install and load the agricolae package before running the LSD.test function below #
#p.adj option in the LSD.test function can be used to apply different adjustments to control error rates#
plot(LSD.test(model_protein, trt = "Trt2", alpha = 0.05))
#The treatments sharing the same letter on the plot are not different#

(LSD.test(model_protein, trt = "Trt2", alpha = 0.05)) # Using outer parentheses prints the output#

#Tukey's test to get observed difference in means, CI and p value#
TukeyHSD(model_protein, conf.level = 0.95)

# Scheffe's test to get observed difference in means, CI and p value #
# Install and load the DescTools package before using the ScheffeTest function #
ScheffeTest(model_protein, conf.level = 0.95)

```